function cov_3b0pv71ju(){var path="C:\\Users\\user\\OneDrive - Temasek Polytechnic\\Desktop\\devops\\DVOPS-part1\\utils\\EndOfDay.js";var hash="beac356a516038fb810d33a3de9caeb0f8223b6c";var global=new Function("return this")();var gcv="__coverage__";var coverageData={path:"C:\\Users\\user\\OneDrive - Temasek Polytechnic\\Desktop\\devops\\DVOPS-part1\\utils\\EndOfDay.js",statementMap:{"0":{start:{line:2,column:17},end:{line:2,column:32}},"1":{start:{line:3,column:32},end:{line:3,column:53}},"2":{start:{line:5,column:10},end:{line:5,column:32}},"3":{start:{line:7,column:4},end:{line:36,column:1}},"4":{start:{line:11,column:22},end:{line:11,column:56}},"5":{start:{line:14,column:18},end:{line:14,column:49}},"6":{start:{line:15,column:4},end:{line:33,column:1}},"7":{start:{line:15,column:14},end:{line:15,column:15}},"8":{start:{line:16,column:28},end:{line:16,column:41}},"9":{start:{line:19,column:12},end:{line:32,column:11}},"10":{start:{line:21,column:12},end:{line:23,column:13}},"11":{start:{line:22,column:14},end:{line:22,column:90}},"12":{start:{line:25,column:16},end:{line:25,column:43}},"13":{start:{line:26,column:16},end:{line:26,column:90}},"14":{start:{line:27,column:17},end:{line:27,column:69}},"15":{start:{line:35,column:0},end:{line:35,column:85}},"16":{start:{line:40,column:0},end:{line:42,column:2}}},fnMap:{"0":{name:"EndOfDay",decl:{start:{line:6,column:15},end:{line:6,column:23}},loc:{start:{line:6,column:32},end:{line:37,column:1}},line:6}},branchMap:{"0":{loc:{start:{line:19,column:12},end:{line:32,column:11}},type:"if",locations:[{start:{line:19,column:12},end:{line:32,column:11}},{start:{line:19,column:12},end:{line:32,column:11}}],line:19},"1":{loc:{start:{line:21,column:12},end:{line:23,column:13}},type:"if",locations:[{start:{line:21,column:12},end:{line:23,column:13}},{start:{line:21,column:12},end:{line:23,column:13}}],line:21}},s:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0},f:{"0":0},b:{"0":[0,0],"1":[0,0]},_coverageSchema:"1a1c01bbd47fc00a2c39e90264f33305004495a9",hash:"beac356a516038fb810d33a3de9caeb0f8223b6c"};var coverage=global[gcv]||(global[gcv]={});if(!coverage[path]||coverage[path].hash!==hash){coverage[path]=coverageData;}var actualCoverage=coverage[path];{// @ts-ignore
cov_3b0pv71ju=function(){return actualCoverage;};}return actualCoverage;}cov_3b0pv71ju();const{util}=(cov_3b0pv71ju().s[0]++,require('chai'));const{readJSON,writeJSON}=(cov_3b0pv71ju().s[1]++,require('./UserUtil'));const fs=(cov_3b0pv71ju().s[2]++,require('fs').promises);async function EndOfDay(req,res){cov_3b0pv71ju().f[0]++;cov_3b0pv71ju().s[3]++;try{const allProfile=(cov_3b0pv71ju().s[4]++,await readJSON('utils/users.json'));var todaydate=(cov_3b0pv71ju().s[5]++,new Date().toLocaleDateString());//to check with a new day
cov_3b0pv71ju().s[6]++;for(var i=(cov_3b0pv71ju().s[7]++,0);i<allProfile.length;i++){var curcurrProfile=(cov_3b0pv71ju().s[8]++,allProfile[i]);cov_3b0pv71ju().s[9]++;if(curcurrProfile.date==todaydate){cov_3b0pv71ju().b[0][0]++;cov_3b0pv71ju().s[10]++;//if date is same as current day, to send info of users that worked that day, this function is designed to collect information of all before the clock hits midnight
//curcurrProfile.time_in ='';
if(curcurrProfile.time_in!=''){cov_3b0pv71ju().b[1][0]++;cov_3b0pv71ju().s[11]++;await fs.writeFile('utils/eod.json',JSON.stringify(curcurrProfile),'utf-8');}else{cov_3b0pv71ju().b[1][1]++;}//writes current info into eod.json
cov_3b0pv71ju().s[12]++;curcurrProfile.time_in='';cov_3b0pv71ju().s[13]++;await fs.writeFile('utils/users.json',JSON.stringify(allProfile),'utf-8');cov_3b0pv71ju().s[14]++;return res.status(201).json({message:'End of day'});}else{cov_3b0pv71ju().b[0][1]++;}}}catch(error){cov_3b0pv71ju().s[15]++;//return res.status(500).json({message: error.message});
return res.status(500).json({message:'no on has timed in',todaydate,curcurrProfile});}};cov_3b0pv71ju().s[16]++;module.exports={EndOfDay};
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJjb3ZfM2IwcHY3MWp1IiwiYWN0dWFsQ292ZXJhZ2UiLCJ1dGlsIiwicyIsInJlcXVpcmUiLCJyZWFkSlNPTiIsIndyaXRlSlNPTiIsImZzIiwicHJvbWlzZXMiLCJFbmRPZkRheSIsInJlcSIsInJlcyIsImYiLCJhbGxQcm9maWxlIiwidG9kYXlkYXRlIiwiRGF0ZSIsInRvTG9jYWxlRGF0ZVN0cmluZyIsImkiLCJsZW5ndGgiLCJjdXJjdXJyUHJvZmlsZSIsImRhdGUiLCJiIiwidGltZV9pbiIsIndyaXRlRmlsZSIsIkpTT04iLCJzdHJpbmdpZnkiLCJzdGF0dXMiLCJqc29uIiwibWVzc2FnZSIsImVycm9yIiwibW9kdWxlIiwiZXhwb3J0cyJdLCJzb3VyY2VzIjpbIkVuZE9mRGF5LmpzIl0sInNvdXJjZXNDb250ZW50IjpbIlxyXG5jb25zdCB7IHV0aWwgfSA9IHJlcXVpcmUoJ2NoYWknKTtcclxuY29uc3QgeyByZWFkSlNPTiwgd3JpdGVKU09OIH0gPSByZXF1aXJlKCcuL1VzZXJVdGlsJylcclxuXHJcbmNvbnN0IGZzID1yZXF1aXJlKCdmcycpLnByb21pc2VzO1xyXG5hc3luYyBmdW5jdGlvbiBFbmRPZkRheShyZXEscmVzKXtcclxuICAgIHRyeXtcclxuICAgIFxyXG5cclxuXHJcbiAgICBjb25zdCBhbGxQcm9maWxlID1hd2FpdCByZWFkSlNPTigndXRpbHMvdXNlcnMuanNvbicpO1xyXG5cclxuICAgXHJcbiAgICB2YXIgdG9kYXlkYXRlPW5ldyBEYXRlKCkudG9Mb2NhbGVEYXRlU3RyaW5nKCk7Ly90byBjaGVjayB3aXRoIGEgbmV3IGRheVxyXG4gICAgZm9yKHZhciBpPTA7aTxhbGxQcm9maWxlLmxlbmd0aDtpKyspe1xyXG4gICAgICAgIHZhciBjdXJjdXJyUHJvZmlsZSA9YWxsUHJvZmlsZVtpXTtcclxuICAgICAgICBcclxuXHJcbiAgICAgICAgICAgIGlmKGN1cmN1cnJQcm9maWxlLmRhdGU9PSB0b2RheWRhdGUpey8vaWYgZGF0ZSBpcyBzYW1lIGFzIGN1cnJlbnQgZGF5LCB0byBzZW5kIGluZm8gb2YgdXNlcnMgdGhhdCB3b3JrZWQgdGhhdCBkYXksIHRoaXMgZnVuY3Rpb24gaXMgZGVzaWduZWQgdG8gY29sbGVjdCBpbmZvcm1hdGlvbiBvZiBhbGwgYmVmb3JlIHRoZSBjbG9jayBoaXRzIG1pZG5pZ2h0XHJcbiAgICAgICAgICAgIC8vY3VyY3VyclByb2ZpbGUudGltZV9pbiA9Jyc7XHJcbiAgICAgICAgICAgIGlmKGN1cmN1cnJQcm9maWxlLnRpbWVfaW4hPScnKXtcclxuICAgICAgICAgICAgICBhd2FpdCBmcy53cml0ZUZpbGUoJ3V0aWxzL2VvZC5qc29uJyxKU09OLnN0cmluZ2lmeShjdXJjdXJyUHJvZmlsZSksJ3V0Zi04Jyk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgLy93cml0ZXMgY3VycmVudCBpbmZvIGludG8gZW9kLmpzb25cclxuICAgICAgICAgICAgICAgIGN1cmN1cnJQcm9maWxlLnRpbWVfaW4gPScnO1xyXG4gICAgICAgICAgICAgICAgYXdhaXQgZnMud3JpdGVGaWxlKCd1dGlscy91c2Vycy5qc29uJyxKU09OLnN0cmluZ2lmeShhbGxQcm9maWxlKSwndXRmLTgnKTtcclxuICAgICAgICAgICAgICAgICByZXR1cm4gcmVzLnN0YXR1cygyMDEpLmpzb24oe21lc3NhZ2U6J0VuZCBvZiBkYXknfSk7XHJcbiAgICAgICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgIGVsc2V7XHJcbiAgICAgICAgICAgXHJcbiAgICAgICAgICB9XHJcbn19Y2F0Y2goZXJyb3Ipe1xyXG4vL3JldHVybiByZXMuc3RhdHVzKDUwMCkuanNvbih7bWVzc2FnZTogZXJyb3IubWVzc2FnZX0pO1xyXG5yZXR1cm4gcmVzLnN0YXR1cyg1MDApLmpzb24oe21lc3NhZ2U6J25vIG9uIGhhcyB0aW1lZCBpbicsdG9kYXlkYXRlLGN1cmN1cnJQcm9maWxlfSk7XHJcbn1cclxufTtcclxuXHJcblxyXG5t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